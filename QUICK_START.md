# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `/api/login`
- –¢–µ–ø–µ—Ä—å –≤—ã–≤–æ–¥—è—Ç—Å—è –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–∑ Supabase –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ—á–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
- –í—ã–≤–æ–¥–∏—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è

### 2. –£–ª—É—á—à–µ–Ω endpoint `/api/users`
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–º–µ—Ä—ã –ø–∞—Ä–æ–ª–µ–π –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

### 3. –î–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π endpoint `/api/init-users` (POST)
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `backend/data/users.json` –≤ Supabase
- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å websockets
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è `websockets` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å Python 3.14
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–µ—Ä—Å–∏—è `supabase`

---

## üîß –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

Backend —Å–µ—Ä–≤–µ—Ä —É–∂–µ –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:5000

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ Supabase

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ:
```
http://localhost:5000/api/users
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤ `[]`:**
‚Üí –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –®–∞–≥—É 2

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
‚Üí –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –®–∞–≥—É 3

### –®–∞–≥ 2: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Supabase

–í—ã–ø–æ–ª–Ω–∏—Ç–µ POST –∑–∞–ø—Ä–æ—Å (–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ curl, Postman –∏–ª–∏ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ):

```bash
curl -X POST http://localhost:5000/api/init-users
```

–ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –Ω–æ–≤–æ–µ –æ–∫–Ω–æ PowerShell –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```powershell
Invoke-WebRequest -Uri http://localhost:5000/api/init-users -Method POST
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```json
{
  "message": "Users initialized successfully",
  "count": 31
}
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Row Level Security (RLS) –≤ Supabase

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://supabase.com
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç `jqfifytmlpofxzwkeavm`
3. Table Editor ‚Üí `users`
4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É **RLS** (—Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)

**–ï—Å–ª–∏ RLS –≤–∫–ª—é—á—ë–Ω (Enable RLS = ON):**

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –≤ SQL Editor:
```sql
-- –í–∞—Ä–∏–∞–Ω—Ç 1: –û—Ç–∫–ª—é—á–∏—Ç—å RLS (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
ALTER TABLE users DISABLE ROW LEVEL SECURITY;

-- –ò–õ–ò –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞—Ç—å policy –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è
CREATE POLICY "Allow public read access"
ON users
FOR SELECT
TO anon
USING (true);
```

### –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é

1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173 (frontend)
2. –í–≤–µ–¥–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –ø–∞—Ä–æ–ª—å: **`N3PqH8M6`**
3. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–æ—è–≤–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ë–µ–∫—Ç—É—Ä!"
- ‚úÖ Redirect –Ω–∞ `/menu`
- ‚úÖ –í –ª–æ–≥–∞—Ö backend (PowerShell –æ–∫–Ω–æ) –ø–æ—è–≤–∏—Ç—Å—è:
  ```
  ============================================================
  LOGIN ATTEMPT
  ============================================================
  PASSWORD FROM CLIENT: 'N3PqH8M6'
  ...
  Total users in database: 31
  ...
  USER FOUND: bb34_14 (–ë–µ–∫—Ç—É—Ä)
  LOGIN SUCCESSFUL for user: –ë–µ–∫—Ç—É—Ä
  ============================================================
  ```

### –®–∞–≥ 5: –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ ‚Üí Deploy –Ω–∞ Render

1. Commit –∏ push –∏–∑–º–µ–Ω–µ–Ω–∏—è:
   ```bash
   git add .
   git commit -m "Fix: Add detailed logging and init-users endpoint"
   git push
   ```

2. Render –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–∏—Å

3. –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
   ```bash
   curl -X POST https://your-app.onrender.com/api/init-users
   ```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render ‚Üí –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å "Users initialized successfully"

---

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏

| –õ–æ–≥–∏–Ω | –ü–∞—Ä–æ–ª—å | –ò–º—è | –†–æ–ª—å |
|-------|--------|-----|------|
| bb34_14 | `N3PqH8M6` | –ë–µ–∫—Ç—É—Ä | Moderator |
| bb34_15 | `9XK4D7S2` | –î–∞—Ç–∫–∞–π—ã–º | Admin |
| bb34_16 | `F6RZ8C5M` | –ê—è–Ω–∞ | Admin |
| bb34_01 | `X7fA9qL2` | –ú—ã—Ä–∑–∞–±–µ–∫ | Student |

---

## üìä –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend

–í PowerShell –æ–∫–Ω–µ, –≥–¥–µ –∑–∞–ø—É—â–µ–Ω backend, –≤—ã —É–≤–∏–¥–∏—Ç–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞.

**–ü—Ä–∏–º–µ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞:**
```
============================================================
LOGIN ATTEMPT
============================================================
PASSWORD FROM CLIENT: 'N3PqH8M6'
PASSWORD LENGTH: 8
REQUEST METHOD: POST
...
STEP 1: Fetching ALL users from Supabase...
Total users in database: 31
Sample passwords in database:
  - User 'bb34_01' has password: 'X7fA9qL2' (length: 8)
  - User 'bb34_02' has password: 'mP4Z8RkQ' (length: 8)
  - User 'bb34_03' has password: '9DqT6WbE' (length: 8)

STEP 2: Searching user with password: 'N3PqH8M6' (length: 8)
Supabase response data type: <class 'list'>
Supabase response data length: 1
USER FOUND: bb34_14 (–ë–µ–∫—Ç—É—Ä)
USER ROLE: Moderator
USER GENDER: Male
LOGIN SUCCESSFUL for user: –ë–µ–∫—Ç—É—Ä
============================================================
```

**–ü—Ä–∏–º–µ—Ä –ù–ï—É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ (—Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è):**
```
============================================================
LOGIN ATTEMPT
============================================================
PASSWORD FROM CLIENT: 'N3PqH8M6'
...
STEP 1: Fetching ALL users from Supabase...
Total users in database: 0
‚ö†Ô∏è  WARNING: Supabase table 'users' is EMPTY!
‚ö†Ô∏è  You need to run POST /api/init-users to load data!
============================================================
```

---

## ‚ùì –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "Database is empty"
**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç–µ `POST /api/init-users`

### –ü—Ä–æ–±–ª–µ–º–∞: "No user found" –Ω–æ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –ø—É—Å—Ç–∞—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ RLS –≤ Supabase (—Å–º. –®–∞–≥ 3)

### –ü—Ä–æ–±–ª–µ–º–∞: Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` —Ñ–∞–π–ª –≤ `StudyCore/backend/.env`:
```
SUPABASE_URL=https://jqfifytmlpofxzwkeavm.supabase.co
SUPABASE_KEY=eyJhbGciOi...
```

### –ü—Ä–æ–±–ª–µ–º–∞: Frontend –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ backend
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 5000

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ó–∞–ø—É—â–µ–Ω backend (http://localhost:5000)
2. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `/api/users` ‚Üí –µ—Å–ª–∏ –ø—É—Å—Ç–æ, –≤—ã–ø–æ–ª–Ω–∏—Ç—å `/api/init-users`
3. ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RLS –≤ Supabase
4. ‚è≥ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ª–æ–∫–∞–ª—å–Ω–æ
5. ‚è≥ –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí commit & push
6. ‚è≥ Deploy –Ω–∞ Render
7. ‚è≥ –í—ã–ø–æ–ª–Ω–∏—Ç—å `/api/init-users` –Ω–∞ production
8. ‚úÖ –ì–æ—Ç–æ–≤–æ!

---

–î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å–º. [SUPABASE_DEBUG_GUIDE.md](./SUPABASE_DEBUG_GUIDE.md)

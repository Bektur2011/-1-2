# üîß –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ç–ª–∞–¥–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Supabase

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –≤–≤–æ–¥–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ "–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å" (HTTP 401).

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1Ô∏è‚É£ **–¢–∞–±–ª–∏—Ü–∞ Supabase –ø—É—Å—Ç–∞—è**
Backend —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û —Å Supabase, –∞ –Ω–µ —Å —Ñ–∞–π–ª–æ–º `users.json`.
–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `users` –≤ Supabase –ø—É—Å—Ç–∞—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.

### 2Ô∏è‚É£ **Row Level Security (RLS) –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã**
–ï—Å–ª–∏ RLS –≤–∫–ª—é—á—ë–Ω, Supabase –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤, –¥–∞–∂–µ –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å.

### 3Ô∏è‚É£ **–ü–∞—Ä–æ–ª–∏ –≤ Supabase –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –≤–≤–æ–¥–∏–º—ã–º–∏**
–í–æ–∑–º–æ–∂–Ω—ã –ª–∏—à–Ω–∏–µ –ø—Ä–æ–±–µ–ª—ã, —Å–∫—Ä—ã—Ç—ã–µ —Å–∏–º–≤–æ–ª—ã –∏–ª–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö.

---

## üìã –ü–æ—à–∞–≥–æ–≤–∞—è –æ—Ç–ª–∞–¥–∫–∞

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Supabase

**–û—Ç–∫—Ä–æ–π—Ç–µ Supabase Dashboard:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ https://supabase.com
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. Table Editor ‚Üí `users`

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
- ‚úÖ –¢–∞–±–ª–∏—Ü–∞ `users` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- ‚úÖ –í —Ç–∞–±–ª–∏—Ü–µ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ü–æ–ª–µ `password` –∏–º–µ–µ—Ç —Ç–∏–ø `TEXT`
- ‚úÖ –ü–∞—Ä–æ–ª–∏ –∑–∞–ø–∏—Å–∞–Ω—ã –±–µ–∑ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Row Level Security (RLS)

**–í Supabase Dashboard:**
1. Table Editor ‚Üí `users`
2. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É **RLS** (—Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)

**–ï—Å–ª–∏ RLS –≤–∫–ª—é—á—ë–Ω:**

#### –í–∞—Ä–∏–∞–Ω—Ç –ê: –û—Ç–∫–ª—é—á–∏—Ç—å RLS (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
```sql
ALTER TABLE users DISABLE ROW LEVEL SECURITY;
```

#### –í–∞—Ä–∏–∞–Ω—Ç –ë: –°–æ–∑–¥–∞—Ç—å Policy –¥–ª—è –ø—É–±–ª–∏—á–Ω–æ–≥–æ —á—Ç–µ–Ω–∏—è
```sql
CREATE POLICY "Allow public read access"
ON users
FOR SELECT
TO anon
USING (true);
```

### –®–∞–≥ 3: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (–µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è)

**–ï—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ `users` –ø—É—Å—Ç–∞—è, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `users.json`:**

```bash
# –û—Ç–ø—Ä–∞–≤—å—Ç–µ POST –∑–∞–ø—Ä–æ—Å –Ω–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
curl -X POST https://your-app.onrender.com/api/init-users
```

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Postman/Insomnia —Å –º–µ—Ç–æ–¥–æ–º **POST** –Ω–∞ endpoint `/api/init-users`.

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:**
- –≠—Ç–æ—Ç endpoint —Ä–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –¢–û–õ–¨–ö–û –û–î–ò–ù –†–ê–ó –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¢–û–õ–¨–ö–û Supabase –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞

**–ù–∞ Render.com:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å
2. Logs ‚Üí View Logs
3. –ù–∞–π–¥–∏—Ç–µ —Å—Ç—Ä–æ–∫–∏ —Å `LOGIN ATTEMPT`

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å:**
```
============================================================
LOGIN ATTEMPT
============================================================
PASSWORD FROM CLIENT: 'N3PqH8M6'
PASSWORD LENGTH: 8
REQUEST METHOD: POST
...
STEP 1: Fetching ALL users from Supabase...
Total users in database: 31  ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å > 0
Sample passwords in database:
  - User 'bb34_01' has password: 'X7fA9qL2' (length: 8)
...
STEP 2: Searching user with password: 'N3PqH8M6' (length: 8)
Supabase response data length: 1  ‚Üê –î–æ–ª–∂–Ω–æ –±—ã—Ç—å 1
USER FOUND: bb34_14 (–ë–µ–∫—Ç—É—Ä)
LOGIN SUCCESSFUL for user: –ë–µ–∫—Ç—É—Ä
============================================================
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ:**
- `Total users in database: 0` ‚Üí –¢–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –®–∞–≥ 3
- `LOGIN FAILED: No user found` ‚Üí –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–æ–ª—å –∏–ª–∏ RLS

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ Render

**–í Render Dashboard:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å
2. Environment ‚Üí Environment Variables

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
```
SUPABASE_URL=https://jqfifytmlpofxzwkeavm.supabase.co
SUPABASE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- ‚úÖ –ë–µ–∑ –∫–∞–≤—ã—á–µ–∫
- ‚úÖ –ë–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ
- ‚úÖ –ë–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ —Å—Ç—Ä–æ–∫
- ‚úÖ SUPABASE_KEY –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **anon public key** (–Ω–µ service_role!)

---

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ –ø–∞—Ä–æ–ª–∏ –∏–∑ users.json

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–∞—Ä–æ–ª–∏:

| –õ–æ–≥–∏–Ω | –ü–∞—Ä–æ–ª—å | –ò–º—è | –†–æ–ª—å |
|-------|--------|-----|------|
| bb34_14 | `N3PqH8M6` | –ë–µ–∫—Ç—É—Ä | Moderator |
| bb34_15 | `9XK4D7S2` | –î–∞—Ç–∫–∞–π—ã–º | Admin |
| bb34_01 | `X7fA9qL2` | –ú—ã—Ä–∑–∞–±–µ–∫ | Student |

---

## üîç –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ endpoints (–¥–æ–±–∞–≤–ª–µ–Ω—ã)

### GET /api/users
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Supabase + –æ–±—Ä–∞–∑—Ü—ã –ø–∞—Ä–æ–ª–µ–π –≤ –ª–æ–≥–∞—Ö.

```bash
curl https://your-app.onrender.com/api/users
```

### POST /api/init-users
–ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ `backend/data/users.json` –≤ Supabase.
**–†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è!**

```bash
curl -X POST https://your-app.onrender.com/api/init-users
```

---

## ‚úÖ –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. ‚úÖ –í Supabase —Ç–∞–±–ª–∏—Ü–µ `users` –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ
2. ‚úÖ RLS –ª–∏–±–æ –æ—Ç–∫–ª—é—á—ë–Ω, –ª–∏–±–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ policy
3. ‚úÖ –ü—Ä–∏ –≤–≤–æ–¥–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–∞—Ä–æ–ª—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `N3PqH8M6`)
4. ‚úÖ Backend –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç—É—Å 200 OK
6. ‚úÖ Frontend –¥–µ–ª–∞–µ—Ç redirect –Ω–∞ `/menu`
7. ‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –ë–µ–∫—Ç—É—Ä!" –ø–æ—è–≤–ª—è–µ—Ç—Å—è

---

## üìû –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â—É—é –∫–æ–º–∞–Ω–¥—É –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
curl https://your-app.onrender.com/api/users | jq '.[0]'
```

–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –ø—É—Å—Ç–æ–π `[]` ‚Üí —Ç–∞–±–ª–∏—Ü–∞ –ø—É—Å—Ç–∞—è, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `/api/init-users`

–ï—Å–ª–∏ –æ—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ RLS –∏ –ª–æ–≥–∏ –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
